# 基于评分的随机微分方程生成模型

两类成功的概率生成模型使用的方法是顺序地损坏带有缓慢增加噪声的训练数据，然后学习逆转这种损坏，以形成数据的生成模型。与朗之万动力学的得分匹配(SMLD)估计每个噪声尺度下的得分，然后使用朗之万动力学在生成过程中从噪声尺度递减的序列中采样。去噪扩散概率建模(Denoising Diffusion Probabilistic Modeling，DDPM)训练了一系列的概率模型来反向噪声污染的每一步，利用反向分布的函数形式的知识使训练变得容易处理。对于连续的状态空间，DDPM训练目标隐式地计算每个噪声尺度下的分数。因此，我们将这两个模型类统称为基于得分的生成模型。为了启用新的采样方法，并进一步扩展基于分数的生成模型的能力，我们提出了一个统一的框架，通过随机微分方程(SDEs)的解释来推广先前的方法。

具体来说，我们不是用有限个噪声分布来扰动数据，而是考虑一个按照扩散过程随时间演化的分布连续体。该过程将数据点逐步扩散到随机噪声中，并由一个不依赖于数据且没有可训练参数的预定SDE给出。通过反转这一过程，我们可以将随机噪声平滑地模塑成数据用于样本生成。关键的是，这个逆过程满足一个逆时间SDE，它可以从**给定边缘概率密度作为时间函数的得分的正向SDE**中推导出来。因此，我们可以通过训练一个依赖于时间的神经网络来估计分数，然后用数值方法产生样本来近似逆时SDE

![](https://cdn.jsdelivr.net/gh/keshuigu/images@main/imgs/202408160956719.png)

我们提出的框架具有若干理论和实践贡献：

- 灵活的采样和似然计算：我们可以使用任何通用的SDE求解器来集成反向时间SDE进行采样。此外，我们还提出了两种对一般SDEs不适用的特殊方法：(i)将数值SDE求解器与基于得分的MCMC(马尔可夫蒙特卡洛)方法相结合的预测-校正(PC)采样器，如郎之万MCMC和HMC；(ii)基于概率流常微分方程(ODE)的确定性采样器。前者是对现有基于评分模型的抽样方法的统一和改进。后者允许通过黑盒ODE求解器进行快速自适应采样、通过隐码进行灵活的数据操作、唯一可识别的编码以及精确似然计算。
- 可控生成：我们可以通过训练期间无法获得的信息来调节生成过程，因为条件反向时间SDE可以从无条件分数中有效地估计出来。这使得诸如类条件生成、图像修复、彩色化和其他反问题等应用都可以在不需要重新训练的情况下使用单一的无条件基于分数的模型实现。
- 统一框架：我们的框架提供了一种统一的方式来探索和调整各种SDEs，以改进基于评分的生成模型。SMLD和DDPM的方法可以合并到我们的框架中，作为两个独立的SDEs的离散化。尽管最近有报道称DDPM比SMLD具有更高的样本质量，但我们表明，在我们的框架允许的更好的架构和新的采样算法下，后者可以在CIFAR - 10上实现新的最先进的Inception分数(9.89)和FID分数(2.20)，以及从基于分数的模型中首次高保真地生成1024 x 1024图像。此外，我们在我们的框架下提出了一个新的SDE，在均匀去量化的CIFAR - 10图像上达到了2.99 bit / dim的似然值，在这个任务上设置了一个新的记录。